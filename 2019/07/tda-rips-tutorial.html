<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Rips Filtration Tutorial for the R-TDA Package | R Package TDA Documentation</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Rips Filtration Tutorial for the R-TDA Package" />
<meta name="author" content="Robin Belton, Ben Holmgren and Jordan Schupbach" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Various tutorials on important techniques in topological data analysis. Tutorials made with the final goal in mind to use the R package TDA in order to actually implement each technique." />
<meta property="og:description" content="Various tutorials on important techniques in topological data analysis. Tutorials made with the final goal in mind to use the R package TDA in order to actually implement each technique." />
<link rel="canonical" href="https://comptag.github.io/rpackage_tutorials/2019/07/tda-rips-tutorial.html" />
<meta property="og:url" content="https://comptag.github.io/rpackage_tutorials/2019/07/tda-rips-tutorial.html" />
<meta property="og:site_name" content="R Package TDA Documentation" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-07-22T00:00:00+00:00" />
<script type="application/ld+json">
{"description":"Various tutorials on important techniques in topological data analysis. Tutorials made with the final goal in mind to use the R package TDA in order to actually implement each technique.","mainEntityOfPage":{"@type":"WebPage","@id":"https://comptag.github.io/rpackage_tutorials/2019/07/tda-rips-tutorial.html"},"@type":"BlogPosting","url":"https://comptag.github.io/rpackage_tutorials/2019/07/tda-rips-tutorial.html","headline":"Rips Filtration Tutorial for the R-TDA Package","dateModified":"2019-07-22T00:00:00+00:00","datePublished":"2019-07-22T00:00:00+00:00","author":{"@type":"Person","name":"Robin Belton, Ben Holmgren and Jordan Schupbach"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/rpackage_tutorials/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://comptag.github.io/rpackage_tutorials/feed.xml" title="R Package TDA Documentation" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/rpackage_tutorials/">R Package TDA Documentation</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/rpackage_tutorials/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Rips Filtration Tutorial for the R-TDA Package</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-07-22T00:00:00+00:00" itemprop="datePublished">Jul 22, 2019
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Robin Belton, Ben Holmgren and Jordan Schupbach</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Warning in install.packages(p, dep = TRUE): installation of package
## 'magick' had non-zero exit status</code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Warning in install.packages(p, dep = TRUE): installation of package
## 'animation' had non-zero exit status</code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Error in library(p, character.only = TRUE): there is no package called 'animation'</code></pre></figure>

<h1 id="introduction">Introduction</h1>
<p>Our ultimate goal is to understand Persistent Homology and be able to compute Persistence
Diagrams using the R-TDA package. In order to get there, we must first understand filtrations.
In this tutorial, we will work with the Vietoris Rips Filtration, or Rips Filtration for short.
Suppose we are given a finite set of points in <script type="math/tex">\mathbb{R}^n</script> denoted by <script type="math/tex">S</script>. The set of
points, <script type="math/tex">S</script>, is topologically uninteresting. How can we fix this? Yes, you guessed it - we 
can construct a Rips complex from the points in <script type="math/tex">S</script>! The Rips Filtration is a specific nested 
sequence of Rips complexes over <script type="math/tex">S</script> that can be later used to compute Persistent Homology.</p>

<h1 id="objectives">Objectives</h1>
<p>By the end of this tutorial you will be able to:</p>

<ul>
  <li>Define <script type="math/tex">n</script>-simplices and simplicial complexes.</li>
  <li>Compute a Rips Complex and Rips Filtration from a finite set of points in
<script type="math/tex">\mathbb{R}^n</script> by hand.</li>
  <li>Name a few exciting applications of the Rips complexes and filtrations.</li>
  <li>Compute a Rips Filtration from a finite set of points in <script type="math/tex">\mathbb{R}^n</script> using the R-TDA package.</li>
</ul>

<h1 id="theory">Theory</h1>

<p>First we breifly describe the mathematical foundations behind a Rips Filtration including
simplicial complexes, filtrations, and the Rips complex. For more details on the theory, 
see <a class="citation" href="#edelsbrunner:2010">(Edelsbrunner &amp; Harer, 2010)</a>.</p>

<h3 id="triangle-appreciation">Triangle Appreciation</h3>

<p>We construct a Rips Complex from simplices of varying dimensions which are dimensional
generalizations of triangles. More specifically, an <em><script type="math/tex">n</script>-simplex</em> is the convex hull of <script type="math/tex">n+1</script>
affinely independent points.</p>

<center>
<embed width="70%" src="../../assets/tda-rips/simplices.svg" type="image/svg+xml" />
</center>

<p>A simplicial complex is a nice way of combining simplices. In particular, a <em>simplicial complex</em>
is a finite collection of simplices, <script type="math/tex">K</script>, such that (1) if <script type="math/tex">\sigma \in K</script> and <script type="math/tex">\tau\leq \sigma</script>, then <script type="math/tex">\tau \in K</script>, and (2) if <script type="math/tex">\sigma, \sigma'\in K</script>, then <script type="math/tex">\sigma\cap \sigma'</script> is either empty or a face of both. A <em>face</em> of a simplex is the convex hull of a subset of the 
vertices in the simplex.</p>

<center>
<embed width="40%" src="../../assets/tda-rips/simplicialcomplex.svg" type="image/svg+xml" />
</center>

<h3 id="rips-complex">Rips Complex</h3>

<p>Now we explain how to construct a Rips complex from a finite set of points, but first we must
start with some preliminary definitions. The <em>diameter</em> of a set of points is the maximum distance between any two points in the set. An <em>abstract simplicial complex</em> is a finite collection of sets, <script type="math/tex">A</script>, such that if <script type="math/tex">a\in A</script> and <script type="math/tex">b\subset a</script> implies <script type="math/tex">b\in A</script>. The elements <script type="math/tex">a\in A</script> are the simplices where dim<script type="math/tex">(a)=</script>card<script type="math/tex">(a)-1</script>.</p>

<center>
<embed width="80%" src="../../assets/tda-rips/asc.svg" type="image/svg+xml" />
</center>

<p>Let <script type="math/tex">S</script> be finite set of points in <script type="math/tex">\mathbb{R}^n</script>. Let <script type="math/tex">r\geq 0</script>. The Rips complex of <script type="math/tex">S</script> and <script type="math/tex">r</script> is the abstract simplicial complex of <script type="math/tex">\text{VR}(S, r)</script>, which consists of all subsets of diameter at most <script type="math/tex">r</script>:</p>

<script type="math/tex; mode=display">\text{VR}(S, r):=\{\sigma\subset S \mid \text{ diam}(\sigma)\leq r\}.</script>

<p>Geometrically, this means we consider balls of radius, <script type="math/tex">\frac{r}{2}</script>, centered at each point in
<script type="math/tex">S</script>. Whenever <script type="math/tex">d</script> balls have pairwise intersections, we add a <script type="math/tex">d-1</script> simplex. For this
tutorial, we will use the standard Euclidean distance (unless stated otherwise) to compute a Rips
complex. However, one could use any metric.</p>

<p><strong>Note:</strong> Many people also define <script type="math/tex">\text{VR}(S, r) :=\{\sigma\subset S \mid \text{diam}(\sigma)\leq 2r\}</script>.
However, the algorithms used in the R-TDA package use the first definition.</p>

<center>
<embed width="80%" src="../../assets/tda-rips/ripscomplex.svg" type="image/svg+xml" />
</center>

<h3 id="filtrations">Filtrations</h3>

<p>A <em>filtration</em> of a simplicial complex, <script type="math/tex">K</script>, is a nested sequence of subcomplexes starting at the
empty set and ending with the full simplicial complex i.e.,</p>

<script type="math/tex; mode=display">\emptyset \subset K_0 \subset K_1 \subset ... \subset K_n=K.</script>

<p>Going back to the Rips complex, we consider <script type="math/tex">r</script> to be a free parameter. If we vary <script type="math/tex">r</script>, we
get different Rips complexes. There is often not a best choice for <script type="math/tex">r</script>, so why not look at 
all of them!? Observe if we increase <script type="math/tex">r</script>, then we get a family of nested Rips complexes which
gives rise to the <em>Rips filtration</em>.</p>

<p>Let’s work through an example. Let <script type="math/tex">S:=\{(0,0),(1,3),(2,-1),(3,2)\}\subset \mathbb{R}^2</script>. We
want to compute a Rips filtration on <script type="math/tex">S</script> for all <script type="math/tex">r\geq 0</script>. Observe:</p>

<ul>
  <li>when <script type="math/tex">r=\sqrt{5}</script>, the balls of radius <script type="math/tex">\frac{\sqrt{5}}{2}</script> centered at <script type="math/tex">(0,0)</script> and
<script type="math/tex">(2,-1)</script> intersect which means we add a 1-simplex between <script type="math/tex">(0,0)</script> and <script type="math/tex">(2,-1)</script>. Similarly,
we add a 1-simplex between <script type="math/tex">(1,3)</script> and <script type="math/tex">(3,2)</script>.</li>
  <li>when <script type="math/tex">r=\sqrt{10}</script>, we add a two more 1-simplices between <script type="math/tex">(0,0), (1,3)</script>, and <script type="math/tex">(2,-1),
(3,2)</script>.</li>
  <li>when <script type="math/tex">r=\sqrt{13}</script>, we add two 2-simplices between <script type="math/tex">(0,0),(1,3),(2,-1)</script> and
<script type="math/tex">(1,3),(2,-1),(3,2)</script>.</li>
  <li>when <script type="math/tex">r=\sqrt{17}</script>, we add a 3-simplex.</li>
</ul>

<p>Here is an illustration of the Rips filtration on <script type="math/tex">S</script>.</p>

<center>
<embed width="90%" src="../../assets/tda-rips/ripsfilt.svg" type="image/svg+xml" />
</center>

<h1 id="applications-of-rips-complexes-and-filtrations">Applications of Rips Complexes and Filtrations</h1>

<p>Now that we have discussed the theory, let’s talk about some of the applications! A Rips
filtration is used on point cloud data. A common form of these types of data are location data.
For example:</p>

<ul>
  <li>Galaxy Data which provides coordinates of stars in different galaxies</li>
  <li>GPS coordinates of Airports on Earth</li>
</ul>

<p>The Rips complex provides information on how close the data points are to each other. Furthermore, the
holes in the complex can provide information on where data are not present. Lastly, the topological
information given by taking a Rips filtration can be studied using Persistent Homology (see next tutorial)
which is often used to analyze these types of data.</p>

<p>Another application is studying coverage in sensor networks. The problem is to look a set of sensors and
find how much coverage the sensors provide. Vin De Silva and Robert Ghrist studied this problem using Rips
complexes since the complex can be determined easily from pairwise communication data. See <a class="citation" href="#ghrist:2007">(Silva &amp; Ghrist, 2007)</a>.</p>

<p>Furthermore, Rips complexes can are used in shape reconstruction in specific situations. This means in
certain situations, the Rips complex of a point cloud, <script type="math/tex">S</script>, with threshold, <script type="math/tex">r</script>, has the same homotopy
type as the union of balls centered around each point in <script type="math/tex">S</script> with radius <script type="math/tex">\frac{r}{2}</script>. See <a class="citation" href="#attali:2013">(Attali, Lieutier, &amp; Salinas, 2013)</a>. They are nice to use since these complexes do not favor a specific type of alignment of the
input.</p>

<p>These are just a few of the applications. There are many more!</p>

<h1 id="computing-the-rips-filtration-using-the-r-tda-package">Computing the Rips Filtration using the R-TDA Package</h1>

<h3 id="toy-example">Toy Example</h3>
<p>First, let’s go back to the example where <script type="math/tex">S:=\{(0,0),(1,3),(2,-1),(3,2)\}</script>. We will compute the Rips filtration using the R-TDA package.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">TDA</span><span class="p">)</span><span class="w"> </span><span class="c1"># upload TDA package</span><span class="w">

</span><span class="n">S</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">-1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="c1"># write S into R</span><span class="w">

</span><span class="n">S_RipsFilt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> 
                             </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"euclidean"</span><span class="p">)</span></code></pre></figure>

<p>Great! So how do we interpret the S_RipsFilt object?</p>

<p>The ripsFiltration function returns a list with a complex list, filtration values vector, a logical variable that states whether or not the values are in increasing order, and a matrix of the coordinates of the vertices if the Euclidean distance is used. The <script type="math/tex">i^{th}</script> element of the complex are the vertices of the <script type="math/tex">i^{th}</script> simplex. Additionally, the <script type="math/tex">i^{th}</script> entry of the filtration values is the filtration value for when the <script type="math/tex">i^{th}</script> simplex appears. See the documentation for this function with this <a href="https://rdrr.io/cran/TDA/man/ripsFiltration.html">link</a>.
 Let’s check this out.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">S_RipsFilt</span><span class="o">$</span><span class="n">cmplx</span><span class="p">[[</span><span class="m">10</span><span class="p">]]</span><span class="w"> </span><span class="c1">#Access vertices for the 10th simplex in the list</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 4 2 1</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">S_RipsFilt</span><span class="o">$</span><span class="n">values</span><span class="p">[</span><span class="m">10</span><span class="p">]</span><span class="w"> </span><span class="c1">#Access filtration value for the 10th simplex in the list</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 3.605551</code></pre></figure>

<p>Our output tells us that we have a 2-simplex on vertices <script type="math/tex">(0,0),(1,3),(3,2)</script> when <script type="math/tex">r=\sqrt{13}</script>. 
This is exactly what we found when we worked through this example by hand. Accessing the other complex 
and filtration value elements will help us verify the rest of the filtration computation we did earlier.</p>

<p>If we want to see an animation of the Rips filtration, we can run the following code. Note this function only works if the data set is two dimensional and the Euclidean distance is used.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">S_RipsFilt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> 
                             </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4.5</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"euclidean"</span><span class="p">)</span><span class="w">

</span><span class="nf">class</span><span class="p">(</span><span class="n">S_RipsFilt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">class</span><span class="p">(</span><span class="n">S_RipsFilt</span><span class="p">),</span><span class="w"> </span><span class="s2">"rips_filt"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">S_RipsFilt</span><span class="p">,</span><span class="w"> </span><span class="n">animate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">fn_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'rips_example.gif'</span><span class="p">,</span><span class="w"> 
     </span><span class="n">lout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span></code></pre></figure>

<center>
<img width="80%" src="../../assets/tda-rips/rips_example.gif" />
</center>

<h3 id="non-euclidean-distance-example">Non Euclidean Distance Example</h3>
<p>Now we will compute a Rips filtration on <script type="math/tex">S</script>, but this time using the Manhattan distance or <script type="math/tex">\ell_1</script> norm. Recall, that for points, <script type="math/tex">\textbf{x}=(x_1,...,x_n)</script> and <script type="math/tex">\textbf{y}=(y_1,...,y_n)\in \mathbb{R}^n</script>,
the Manhattan distance, <script type="math/tex">d_M(\textbf{x},\textbf{y})</script> is defined as:</p>

<script type="math/tex; mode=display">d_M(\textbf{x},\textbf{y}):=\sum_{i=1}^{n}|x_i-y_i|.</script>

<p>In order to compute the Rips filtration on <script type="math/tex">S</script> for this metric, we need to create a distance
matrix in R. We can do this using the following code.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dist_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dist</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"manhattan"</span><span class="p">,</span><span class="w"> </span><span class="n">diag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span></code></pre></figure>

<p>Now when we use the ripsFiltration function, we will write dist_matrix as the first argument instead of <script type="math/tex">S</script>. Additionally, the fourth argument will change to dist = “arbitrary”.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">S_RipsFilt_Manhattan</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">dist_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> 
                                       </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"arbitrary"</span><span class="p">)</span><span class="w"> </span></code></pre></figure>

<p>This time when we compute the Rips complex with <script type="math/tex">r=\sqrt{13}</script> we get the following complex.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">S_RipsFilt_Manhattan</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">dist_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> 
                                       </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="m">13</span><span class="p">),</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"arbitrary"</span><span class="p">)</span><span class="w">

</span><span class="n">lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w">
     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rips Complex with Manhattan Distance for r = sqrt(13)"</span><span class="p">,</span><span class="w"> 
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S_RipsFilt_Manhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]]))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">polygon</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">S_RipsFilt_Manhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]][[</span><span class="n">idx</span><span class="p">]],</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">],</span><span class="w">
          </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gray"</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S_RipsFilt_Manhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]]))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">polygon</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">S_RipsFilt_Manhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]][[</span><span class="n">idx</span><span class="p">]],</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">],</span><span class="w">
          </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<center>
<embed width="80%" src="../../assets/tda-rips/visualization2.svg" type="image/svg+xml" />
</center>

<p>Hence VR<script type="math/tex">(S, \sqrt{13})</script> with the Manhattan distance is a simplicial complex two edges, while with the Euclidean distance is a simplicial complex with two 2-simplices.</p>

<h3 id="sightings-of-bigfoot-in-montana">Sightings of Bigfoot in Montana</h3>
<p>Lastly, we will work through an example with real data! The Bigfoot Field Researchers Organization (BFRO) is the only scientific research organization studying the Bigfoot/Sasquatch mystery. They publically provide all Bigfoot sighting reports on their <a href="http://www.bfro.net/">website</a>. We will compute the Rips filtration for Bigfoot sightings in Montana with the hope of finding the dead zones where bigfoot has not been sighted in order to keep hikers safe from potential encounters.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#Latitude coordinates of Bigfoot sightings in MT</span><span class="w">
</span><span class="n">latitude</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">48.24750</span><span class="p">,</span><span class="w"> </span><span class="m">48.08350</span><span class="p">,</span><span class="w"> </span><span class="m">48.27750</span><span class="p">,</span><span class="w"> </span><span class="m">48.02611</span><span class="p">,</span><span class="w"> </span><span class="m">48.07834</span><span class="p">,</span><span class="w"> </span><span class="m">48.26880</span><span class="p">,</span><span class="w"> 
              </span><span class="m">48.21167</span><span class="p">,</span><span class="w"> </span><span class="m">48.12780</span><span class="p">,</span><span class="w"> </span><span class="m">48.11556</span><span class="p">,</span><span class="w"> </span><span class="m">48.26810</span><span class="p">,</span><span class="w"> </span><span class="m">48.14720</span><span class="p">,</span><span class="w"> </span><span class="m">48.93228</span><span class="p">,</span><span class="w"> 
              </span><span class="m">47.98170</span><span class="p">,</span><span class="w"> </span><span class="m">48.09853</span><span class="p">,</span><span class="w"> </span><span class="m">47.89250</span><span class="p">,</span><span class="w"> </span><span class="m">47.85730</span><span class="p">,</span><span class="w"> </span><span class="m">47.88950</span><span class="p">,</span><span class="w"> </span><span class="m">47.79111</span><span class="p">,</span><span class="w"> 
              </span><span class="m">47.78530</span><span class="p">,</span><span class="w"> </span><span class="m">48.18640</span><span class="p">,</span><span class="w"> </span><span class="m">48.07440</span><span class="p">,</span><span class="w"> </span><span class="m">48.00280</span><span class="p">,</span><span class="w"> </span><span class="m">47.85556</span><span class="p">,</span><span class="w"> </span><span class="m">47.97205</span><span class="p">,</span><span class="w"> 
              </span><span class="m">47.89010</span><span class="p">,</span><span class="w"> </span><span class="m">47.84650</span><span class="p">,</span><span class="w"> </span><span class="m">47.87725</span><span class="p">,</span><span class="w"> </span><span class="m">48.21095</span><span class="p">,</span><span class="w"> </span><span class="m">48.11509</span><span class="p">,</span><span class="w"> </span><span class="m">47.48500</span><span class="p">,</span><span class="w"> 
              </span><span class="m">47.79222</span><span class="p">,</span><span class="w"> </span><span class="m">48.22336</span><span class="p">,</span><span class="w"> </span><span class="m">47.86405</span><span class="p">,</span><span class="w"> </span><span class="m">48.10500</span><span class="p">,</span><span class="w"> </span><span class="m">48.13025</span><span class="p">,</span><span class="w"> </span><span class="m">48.02073</span><span class="p">,</span><span class="w"> 
              </span><span class="m">47.79250</span><span class="p">)</span><span class="w">

</span><span class="c1">#Longitude coordinates of Bigfoot sightings in MT</span><span class="w">
</span><span class="n">longitude</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-121.9425</span><span class="p">,</span><span class="w"> </span><span class="m">-121.9683</span><span class="p">,</span><span class="w"> </span><span class="m">-121.8078</span><span class="p">,</span><span class="w"> </span><span class="m">-121.6406</span><span class="p">,</span><span class="w"> </span><span class="m">-121.7363</span><span class="p">,</span><span class="w"> 
               </span><span class="m">-121.7050</span><span class="p">,</span><span class="w"> </span><span class="m">-121.6769</span><span class="p">,</span><span class="w"> </span><span class="m">-121.7692</span><span class="p">,</span><span class="w"> </span><span class="m">-122.0958</span><span class="p">,</span><span class="w"> </span><span class="m">-121.3314</span><span class="p">,</span><span class="w"> 
               </span><span class="m">-121.3819</span><span class="p">,</span><span class="w"> </span><span class="m">-121.9995</span><span class="p">,</span><span class="w"> </span><span class="m">-122.0447</span><span class="p">,</span><span class="w"> </span><span class="m">-121.8135</span><span class="p">,</span><span class="w"> </span><span class="m">-122.0111</span><span class="p">,</span><span class="w"> 
               </span><span class="m">-121.6352</span><span class="p">,</span><span class="w"> </span><span class="m">-121.8134</span><span class="p">,</span><span class="w"> </span><span class="m">-122.1914</span><span class="p">,</span><span class="w"> </span><span class="m">-121.6647</span><span class="p">,</span><span class="w"> </span><span class="m">-122.2612</span><span class="p">,</span><span class="w"> 
               </span><span class="m">-121.7915</span><span class="p">,</span><span class="w"> </span><span class="m">-121.9572</span><span class="p">,</span><span class="w"> </span><span class="m">-121.9697</span><span class="p">,</span><span class="w"> </span><span class="m">-121.4008</span><span class="p">,</span><span class="w"> </span><span class="m">-121.3676</span><span class="p">,</span><span class="w"> 
               </span><span class="m">-122.1357</span><span class="p">,</span><span class="w"> </span><span class="m">-121.8943</span><span class="p">,</span><span class="w"> </span><span class="m">-122.0262</span><span class="p">,</span><span class="w"> </span><span class="m">-121.9677</span><span class="p">,</span><span class="w"> </span><span class="m">-121.5287</span><span class="p">,</span><span class="w"> 
               </span><span class="m">-121.1958</span><span class="p">,</span><span class="w"> </span><span class="m">-121.5777</span><span class="p">,</span><span class="w"> </span><span class="m">-121.6738</span><span class="p">,</span><span class="w"> </span><span class="m">-121.9050</span><span class="p">,</span><span class="w"> </span><span class="m">-121.8510</span><span class="p">,</span><span class="w"> 
               </span><span class="m">-121.3552</span><span class="p">,</span><span class="w"> </span><span class="m">-122.1676</span><span class="p">)</span><span class="w">

</span><span class="c1">#GPS coordinates of Bigfoot sightings in MT</span><span class="w">
</span><span class="n">bigfoot_sightingsMT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span><span class="w"> </span><span class="n">longitude</span><span class="p">)</span></code></pre></figure>

<p>We can plot the data using the following code.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="p">(</span><span class="n">bigfoot_sightingsMT</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">bigfoot_sightingsMT</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Latitude"</span><span class="p">,</span><span class="w"> 
     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Longitude"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"GPS coordinates of Bigfoot sightings 
     in Montana"</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">)</span></code></pre></figure>

<center>
<embed width="80%" src="../../assets/tda-rips/bigfoot.svg" type="image/svg+xml" />
</center>

<p>Now let’s compute the filtration and visualize it with an animation.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">BigfootRipsFilt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">bigfoot_sightingsMT</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> 
                                  </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.6</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"euclidean"</span><span class="p">)</span><span class="w">

</span><span class="nf">class</span><span class="p">(</span><span class="n">BigfootRipsFilt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">class</span><span class="p">(</span><span class="n">BigfootRipsFilt</span><span class="p">),</span><span class="w"> </span><span class="s2">"rips_filt"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">BigfootRipsFilt</span><span class="p">,</span><span class="w"> </span><span class="n">animate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">fn_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'bigfoot_ex.gif'</span><span class="p">,</span><span class="w"> 
     </span><span class="n">lout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span></code></pre></figure>

<center>
<embed width="70%" height="auto" src="../../assets/tda-rips/bigfoot_ex.gif" />
</center>

<p><strong>TODO: find which areas in Montana correspond to the dead zones and add a concluding remark.</strong></p>

<h1 id="references">References</h1>

<ol class="bibliography"><li><span id="edelsbrunner:2010">Edelsbrunner, H., &amp; Harer, J. (2010). <i>Computational Topology - an Introduction.</i> (pp. 1–241). American Mathematical Society.</span></li>
<li><span id="ghrist:2007">Silva, V. de, &amp; Ghrist, R. (2007). Coverage in Sensor Networks via Persistent Homology. <i>Algebraic &amp; Geometric Topology</i>, <i>7</i>. https://doi.org/10.2140/agt.2007.7.339</span></li>
<li><span id="attali:2013">Attali, D., Lieutier, A., &amp; Salinas, D. (2013). Vietoris–Rips Complexes also Provide Topologically Correct Reconstructions of Sampled Shapes. <i>Computational Geometry</i>, <i>46</i>(4), 448–465. https://doi.org/https://doi.org/10.1016/j.comgeo.2012.02.009</span></li></ol>


  </div><a class="u-url" href="/rpackage_tutorials/2019/07/tda-rips-tutorial.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/rpackage_tutorials/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">R Package TDA Documentation</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">R Package TDA Documentation</li><li><a class="u-email" href="mailto:benjamin.holmgren1@students.montana.edu">benjamin.holmgren1@students.montana.edu</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/benholmgren"><svg class="svg-icon"><use xlink:href="/rpackage_tutorials/assets/minima-social-icons.svg#github"></use></svg> <span class="username">benholmgren</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Various tutorials on important techniques in topological data analysis. Tutorials made with the final goal in mind to use the R package TDA in order to actually implement each technique.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
