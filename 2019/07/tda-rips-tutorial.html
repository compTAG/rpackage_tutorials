<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Rips Filtration Tutorial for the R-TDA Package</title>
  <meta name="description" content="">

  
  
  <link rel="stylesheet" href="https://comptag.github.io/rpackage_tutorials//assets/style.css">

  <link rel="canonical" href="https://comptag.github.io/rpackage_tutorials//2019/07/tda-rips-tutorial.html">
  <link rel="alternate" type="application/rss+xml" title="Topology for Data Science" href="https://comptag.github.io/rpackage_tutorials//feed.xml">

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>

    <header class="border-bottom-thick px-2 clearfix">
  <div class="left sm-width-full py-1 mt-1 mt-lg-0">
    <a class="align-middle link-primary text-accent" href="/rpackage_tutorials//">
      Topology for Data Science
    </a>
  </div>
  <div class="right sm-width-full">
    <ul class="list-reset mt-lg-1 mb-2 mb-lg-1">
      
        
      
        
        <li class="inline-block">
          <a class="align-middle link-primary mr-2 mr-lg-0 ml-lg-2" href="/rpackage_tutorials//about/">
            About
          </a>
        </li>
        
      
        
      
        
      
        
      
    </ul>
  </div>
</header>


    <div>
      <article class="container px-2 mx-auto mb4" itemscope itemtype="http://schema.org/BlogPosting">
  <h1 class="h0 col-9 sm-width-full py-4 mt-3 inline-block" itemprop="name headline">Rips Filtration Tutorial for the R-TDA Package</h1>
  <div class="col-4 sm-width-full mt-1 border-top-thin ">
    <p class="mb-3 py-2 bold h4"><time datetime="2019-07-22T00:00:00+00:00" itemprop="datePublished">Jul 22, 2019</time></p>
  </div>

  <div class="prose" itemprop="articleBody">
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<h2 id="introduction">Introduction</h2>

<p>Suppose we are given a finite set, <script type="math/tex">S</script>, of points in <script type="math/tex">\mathbb{R}^n</script>. The set of
points is topologically uninteresting. How can we fix this? Yes, you guessed it: we
can construct a Vietoris Rips (Rips) complex from the points in <script type="math/tex">S</script>! The Rips Filtration is
a specific nested sequence of Rips complexes over <script type="math/tex">S</script>. Both provide geometric and topological
information about our point set. In this tutorial, we explore this idea and how a Rips complex and
filtration can be used to better understand data sets.</p>

<h2 id="objectives">Objectives</h2>

<p>By the end of this tutorial you should be able to:</p>

<ul>
  <li>Define Abstract Simplicial Complexes.</li>
  <li>Compute a Rips complex and Rips filtration from a finite set of points in
<script type="math/tex">\mathbb{R}^n</script> by hand.</li>
  <li>Compute a Rips Filtration from a finite set of points in <script type="math/tex">\mathbb{R}^n</script> using the R-TDA package.</li>
  <li>Name a few applications of the Rips complexes and filtrations.</li>
</ul>

<h2 id="theory">Theory</h2>

<p>First, we breifly describe the mathematical foundations behind a Rips Filtration including
abstract simplicial complexes, filtrations, and the Rips complex. <em>Computation Topology: An Introduction</em>
provides more details on the theory <a class="citation" href="#edelsbrunner:2010">(Edelsbrunner &amp; Harer, 2010)</a>.</p>

<h3 id="triangle-appreciation">Triangle Appreciation</h3>

<p>We construct a Rips complex from simplices of varying dimensions that are generalizations of triangles
of varying dimensions. More specifically, an <em>n-simplex</em> is the smallest convex set of <script type="math/tex">n-1</script> points,
<script type="math/tex">v_0,...,v_{n-1}</script> where <script type="math/tex">v_1-v_0,...,v_{n-1}-v_0</script> are linearly independent.</p>

<center>
<embed width="70%" src="../../assets/tda-rips/simplices.svg" type="image/svg+xml" />
</center>

<p>An <em>abstract simplicial complex</em> is a finite collection of sets, <script type="math/tex">A</script>, that is closed under the subset
relation, i.e., if <script type="math/tex">a\in A</script> and <script type="math/tex">b\subset a</script>, then <script type="math/tex">b\in A</script>. The elements <script type="math/tex">a\in A</script> are the
simplices where dim<script type="math/tex">(a):=</script>card<script type="math/tex">(a)-1</script>. Here, card<script type="math/tex">(a)</script> is the number of points in the set, <script type="math/tex">a</script>.</p>

<center>
<embed width="80%" src="../../assets/tda-rips/asc.svg" type="image/svg+xml" />
</center>

<h3 id="rips-complex">Rips Complex</h3>

<p>Let <script type="math/tex">S</script> be finite set of points in <script type="math/tex">\mathbb{R}^n</script>. Let <script type="math/tex">r\geq 0</script>. The Rips complex of <script type="math/tex">S</script>
and <script type="math/tex">r</script> is the abstract simplicial complex of <script type="math/tex">\text{VR}(S, r)</script> consisting of all subsets
of diameter at most <script type="math/tex">r</script>:</p>

<script type="math/tex; mode=display">\text{VR}(S, r):=\{\sigma\subset S \mid \text{ diam}(\sigma)\leq r\}</script>

<p>where the <em>diameter</em> of a set of points is the maximum distance between any two points in the set.</p>

<p>Geometrically, we can constuct the Rips complex by considering balls of radius <script type="math/tex">\frac{r}{2}</script>,
centered at each point in <script type="math/tex">S</script>. Whenever <script type="math/tex">d</script> balls have pairwise intersections, we add a <script type="math/tex">d-1</script>
dimensional simplex. For this tutorial, we use the standard Euclidean distance (unless stated otherwise)
to compute a Rips complex.</p>

<p>You may be familiar with <em>contact graphs</em> where the vertices represent a geometric object such as a
circle, curve, or polygon, and an edge between two vertices exists if the corresponding two objects
intersect. The Rips complex is a generalization of contact graphs.</p>

<p>Here are some examples of Rips complexes:</p>

<center>
<embed width="80%" src="../../assets/tda-rips/ripscomplex.svg" type="image/svg+xml" />
</center>

<p><strong>Note:</strong> Many people also define <script type="math/tex">\text{VR}(S, r) :=\{\sigma\subset S \mid \text{diam}(\sigma)\leq 2r\}</script>. However, the algorithms used in the R-TDA package use the first definition.</p>

<h3 id="filtrations">Filtrations</h3>

<p>A <em>filtration</em> of a simplicial complex, <script type="math/tex">K</script>, is a nested sequence of subcomplexes starting at the
empty set and ending with the full simplicial complex, i.e.,</p>

<script type="math/tex; mode=display">\emptyset \subset K_0 \subset K_1 \subset ... \subset K_n=K.</script>

<p>Going back to the Rips complex, we consider <script type="math/tex">r</script> to be a free parameter. If we vary <script type="math/tex">r</script>, we
get different Rips complexes. In many data analysis situations, the value of <script type="math/tex">r</script> that best describes
the data is unknown or does not exist, so why not look at all of them!? Observe if we increase <script type="math/tex">r</script>
continuously, then we get a family of nested Rips complexes; the <em>Rips filtration</em>.</p>

<p>Let’s work through an example. Let <script type="math/tex">S:=\{(0,0),(1,3),(2,-1),(3,2)\}\subset \mathbb{R}^2</script>. We
want to compute a Rips filtration on <script type="math/tex">S</script> for all <script type="math/tex">r\geq 0</script>.</p>

<center>
<embed width="90%" src="../../assets/tda-rips/ripsfilt.svg" type="image/svg+xml" />
</center>

<p>Observe:</p>

<ul>
  <li>When <script type="math/tex">% <![CDATA[
r<\sqrt{5} %]]></script>, none of the balls of radius <script type="math/tex">\frac{r}{2}</script> intersect and so <script type="math/tex">\text{VR}(S,r</script>) is
four points.</li>
  <li>When <script type="math/tex">r=\sqrt{5}</script>, the balls of radius <script type="math/tex">\frac{\sqrt{5}}{2}</script> centered at <script type="math/tex">(0,0)</script> and
<script type="math/tex">(2,-1)</script> intersect which means we add a 1-simplex between <script type="math/tex">(0,0)</script> and <script type="math/tex">(2,-1)</script>. Similarly,
we add a 1-simplex between <script type="math/tex">(1,3)</script> and <script type="math/tex">(3,2)</script>.</li>
  <li>When <script type="math/tex">r\in (\sqrt{5},\sqrt{10})</script>, no additional balls of radius <script type="math/tex">\frac{r}{2}</script> intersect which means <script type="math/tex">\text{VR}(S, r)=\text{VR}(S, \sqrt{5}</script>).</li>
  <li>When <script type="math/tex">r=\sqrt{10}</script>, we add a two more 1-simplices between <script type="math/tex">(0,0), (1,3)</script>, and <script type="math/tex">(2,-1),
(3,2)</script>.</li>
  <li>When <script type="math/tex">r \in (\sqrt{10},\sqrt{13})</script>, <script type="math/tex">\text{VR}(S,r)=\text{VR}(S, \sqrt{10}).</script></li>
  <li>When <script type="math/tex">r=\sqrt{13}</script>, we add two 2-simplices between <script type="math/tex">(0,0),(1,3),(2,-1)</script> and
<script type="math/tex">(1,3),(2,-1),(3,2)</script>.</li>
  <li>When <script type="math/tex">r \in (\sqrt{13},\sqrt{17})</script>, <script type="math/tex">\text{VR}(S,r)=\text{VR}(S, \sqrt{13}).</script></li>
  <li>When <script type="math/tex">r=\sqrt{17}</script>, we add a 3-simplex.</li>
  <li>When <script type="math/tex">r>\sqrt{17}</script>, <script type="math/tex">\text{VR}(S,r)=\text{VR}(S, \sqrt{17}).</script></li>
</ul>

<h2 id="applications-of-rips-complexes-and-filtrations">Applications of Rips Complexes and Filtrations</h2>

<p>Now that we have discussed the theory, let’s talk about some of the applications! A Rips
filtration is used on point cloud data or more generally on a data set where there is some notion of distance between all data points. A common form of these types of data are location data.
For example, coordinates of galaxies in the Universe and GPS coordinates of airports on Earth.</p>

<p>The Rips complex provides information on how close the data points are to each other.
Furthermore, the holes in the complex can provide information on where data are not present.
Lastly, the topological information given by taking a Rips filtration can be studied using
persistent homology (tutorial to come soon!).</p>

<p>Another application is studying coverage in sensor networks. The problem is to look at a set
of sensors and find how much coverage the sensors provide.  Robert Ghrist and Vin de Silva
studied this problem using Rips complexes since the complex can be determined easily from
pairwise communication data <a class="citation" href="#ghrist:2007">(Silva &amp; Ghrist, 2007)</a>.</p>

<p>Furthermore, Rips complexes can be used in shape reconstruction. Dominque Attali, Andre Lieutier,
and David Salinas proved that the Rips complex of a point cloud, <script type="math/tex">S</script>, at some threshold has
the same homotopy type as the union of balls centered around each point in <script type="math/tex">S</script> with radius
<script type="math/tex">\frac{r}{2}</script>  <a class="citation" href="#attali:2013">(Attali, Lieutier, &amp; Salinas, 2013)</a>. Rips complexes are nice to use for shape reconstruction
since they do not favor a specific type of alignment of the input.</p>

<p>These are just a few of the applications. There are many more!</p>

<h2 id="computing-the-rips-filtration-using-the-r-tda-package">Computing the Rips Filtration using the R-TDA Package</h2>

<h3 id="toy-example">Toy Example</h3>
<p>First, let’s go back to the example where <script type="math/tex">S=\{(0,0),(1,3),(2,-1),(3,2)\}</script>. We compute the Rips
filtration using the R-TDA package.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">TDA</span><span class="p">)</span><span class="w"> </span><span class="c1"># upload TDA package</span><span class="w">

</span><span class="n">S</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">-1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="c1"># write S into R</span><span class="w">

</span><span class="c1"># Compute Rips Filtration. maxdimension is max dim of homological features </span><span class="w">
</span><span class="c1"># to be computed, maxscale is the filtration limit.</span><span class="w">
</span><span class="n">RipsFilt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> 
                             </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"euclidean"</span><span class="p">)</span></code></pre></figure>

<p>Great! So how do we interpret the RipsFilt object?</p>

<p>The ripsFiltration function returns a list:</p>

<ul>
  <li><strong>complx</strong> is a list where the <script type="math/tex">i^{th}</script> element is a vector of the vertices for the <script type="math/tex">i^{th}</script> simplex.</li>
  <li><strong>values</strong> is a vector where the <script type="math/tex">i^{th}</script> entry is the filtration value for the <script type="math/tex">i^{th}</script> simplex.</li>
  <li><strong>increasing</strong>  is a logical variable that states TRUE if the filtration values in the values vector are in increasing order and FALSE if the filtration values are in decreasing order.</li>
  <li><strong>coordinates</strong> is a matrix representing the coordinates of the vertices. The <script type="math/tex">i^{th}</script> row is the coordinate for the <script type="math/tex">i^{th}</script> vertex. Note the coordinates matrix appears only if the Euclidean distance is used.</li>
</ul>

<p>See the documentation for this function with this <a href="https://rdrr.io/cran/TDA/man/ripsFiltration.html">link</a>.
Let’s check this out.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">RipsFilt</span><span class="o">$</span><span class="n">cmplx</span><span class="p">[[</span><span class="m">10</span><span class="p">]]</span><span class="w"> </span><span class="c1">#Access vertices for the 10th simplex in the list</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 4 2 1</code></pre></figure>

<p>Our output tells us that we have a 2-simplex on vertices <script type="math/tex">(0,0),(1,3),(3,2)</script>. Let’s see at which filtration value this appears.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">RipsFilt</span><span class="o">$</span><span class="n">values</span><span class="p">[</span><span class="m">10</span><span class="p">]</span><span class="w"> </span><span class="c1">#Access filtration value for the 10th simplex in the list</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 3.605551</code></pre></figure>

<p>So we have a 2-simplex when <script type="math/tex">r=\sqrt{13}</script>. We also found this by hand! Accessing the other complex and filtration value elements verifies the rest of the filtration computation we did earlier.</p>

<p>If we want to see an animation of the Rips filtration, we can run the following code with a plot function. This function has input arguments:</p>

<ul>
  <li><strong>filt</strong> is the Rips filtration object. (So, Ripsfilt from above)</li>
  <li><strong>animate</strong> is a logical variable stating TRUE if you want an animation of the filtration or FALSE if you do not want an animation.</li>
  <li><strong>thresh</strong>  is the threshold value for the Rips complex that will be plotted if animate = FALSE.</li>
  <li><strong>fn_out</strong>  is the name of the file for the animation if animate = TRUE.</li>
  <li><strong>l_out</strong>  is the number of levels of radii used in the animation between 0 and 1.1 times the max distance between any two points if animate = TRUE.</li>
</ul>

<p>Note this function only works if the data set is two dimensional and the Euclidean distance is used.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">plotrix</span><span class="p">)</span><span class="w"> </span><span class="c1"># packages for plot function</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">animation</span><span class="p">)</span><span class="w">

</span><span class="nf">class</span><span class="p">(</span><span class="n">RipsFilt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">class</span><span class="p">(</span><span class="n">RipsFilt</span><span class="p">),</span><span class="w"> </span><span class="s2">"rips_filt"</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">RipsFilt</span><span class="p">,</span><span class="w"> </span><span class="n">animate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">fn_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'rips_example.gif'</span><span class="p">,</span><span class="w">
     </span><span class="n">lout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span></code></pre></figure>

<center>
<img width="80%" src="../../assets/tda-rips/rips_example.gif" />
</center>

<p>Furthermore, we can look at the Rips complex at a threshold of <script type="math/tex">\sqrt{14}</script>, by adding the argument, thresh = <script type="math/tex">\sqrt{14}</script> and changing animate = FALSE to animate = TRUE.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="p">(</span><span class="n">RipsFilt</span><span class="p">,</span><span class="w"> </span><span class="n">thresh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="m">14</span><span class="p">),</span><span class="w"> </span><span class="n">animate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span></code></pre></figure>

<center>
<embed width="80%" src="../../assets/tda-rips/toycomplexx.svg" type="image/svg+xml" />
</center>

<h3 id="non-euclidean-distance-example">Non-Euclidean Distance Example</h3>
<p>Now we compute a Rips filtration on <script type="math/tex">S</script>, but this time using the Manhattan distance or <script type="math/tex">\ell_1</script> norm. Recall, that for points, <script type="math/tex">\textbf{x}=(x_1,...,x_n)</script> and <script type="math/tex">\textbf{y}=(y_1,...,y_n)\in \mathbb{R}^n</script>,
the Manhattan distance, <script type="math/tex">d_1(\textbf{x},\textbf{y})</script> is defined as:</p>

<script type="math/tex; mode=display">d_1(\textbf{x},\textbf{y}):=\sum_{i=1}^{n}|x_i-y_i|.</script>

<p>In order to compute the Rips filtration on <script type="math/tex">(S, d_1)</script>, we need to create a distance
matrix in R. We can do this using the following code:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">DistMatrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dist</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"manhattan"</span><span class="p">,</span><span class="w"> </span><span class="n">diag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span></code></pre></figure>

<p>When we use the ripsFiltration function, we write DistMatrix as the first argument instead of <script type="math/tex">S</script>.
Additionally, the fourth argument will change to dist = “arbitrary” to indicate that we are giving our
own distance metric.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">RipsFiltManhattan</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">DistMatrix</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
                                       </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"arbitrary"</span><span class="p">)</span></code></pre></figure>

<p>This time when we compute the Rips complex with <script type="math/tex">r=\sqrt{14}</script>, we get the following complex:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">squash</span><span class="p">)</span><span class="w"> </span><span class="c1"># package for drawing diamonds</span><span class="w">

</span><span class="n">lim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">],</span><span class="w">
     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rips Complex with Manhattan Distance for r = sqrt(14)"</span><span class="p">,</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">S</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">diamond</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="m">14</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgb</span><span class="p">(</span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="m">0.05</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RipsFiltManhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]][</span><span class="n">RipsFiltManhattan</span><span class="o">$</span><span class="n">values</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="m">14</span><span class="p">)]))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">polygon</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">RipsFiltManhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]][[</span><span class="n">idx</span><span class="p">]],</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">],</span><span class="w">
          </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pink"</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RipsFiltManhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]][</span><span class="n">RipsFiltManhattan</span><span class="o">$</span><span class="n">values</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="m">14</span><span class="p">)]))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">polygon</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">RipsFiltManhattan</span><span class="p">[[</span><span class="s2">"cmplx"</span><span class="p">]][[</span><span class="n">idx</span><span class="p">]],</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">],</span><span class="w">
          </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lim</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">)</span></code></pre></figure>

<center>
<embed width="80%" src="../../assets/tda-rips/manhattan.svg" type="image/svg+xml" />
</center>

<p>Hence <script type="math/tex">\text{VR}(S, \sqrt{14})</script> with the Manhattan distance is a simplicial complex with two edges, while with the Euclidean distance is a simplicial complex with two 2-simplices.</p>

<h3 id="sightings-of-bigfoot-in-montana">Sightings of Bigfoot in Montana</h3>
<p>Lastly, we work through an example with real data! The Bigfoot Field Researchers Organization (BFRO) is the only scientific research organization studying the Bigfoot/Sasquatch mystery. They publically provide all Bigfoot sighting reports on their <a href="http://www.bfro.net/">website</a>. We will compute the Rips filtration for Bigfoot sightings in Montana with the hope of finding the where Bigfoot is and is not roaming. Finding the deadzones where Bigfoot is not present could help keep hikers safe from potential encounters.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#Latitude coordinates of Bigfoot sightings in MT</span><span class="w">
</span><span class="n">latitude</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">45.31278</span><span class="p">,</span><span class="m">46.05292</span><span class="p">,</span><span class="m">45.97540</span><span class="p">,</span><span class="m">47.62167</span><span class="p">,</span><span class="m">48.03278</span><span class="p">,</span><span class="m">47.70667</span><span class="p">,</span><span class="w">
              </span><span class="m">46.02962</span><span class="p">,</span><span class="m">47.66724</span><span class="p">,</span><span class="m">46.01833</span><span class="p">,</span><span class="m">46.97694</span><span class="p">,</span><span class="m">46.76389</span><span class="p">,</span><span class="m">45.12266</span><span class="p">,</span><span class="w">
              </span><span class="m">48.27011</span><span class="p">,</span><span class="m">46.76472</span><span class="p">,</span><span class="m">46.18694</span><span class="p">,</span><span class="m">48.36139</span><span class="p">,</span><span class="m">45.22417</span><span class="p">,</span><span class="m">47.60413</span><span class="p">,</span><span class="w">
              </span><span class="m">47.17833</span><span class="p">,</span><span class="m">45.28074</span><span class="p">,</span><span class="m">46.48392</span><span class="p">,</span><span class="m">47.57549</span><span class="p">,</span><span class="m">45.79220</span><span class="p">,</span><span class="m">45.61331</span><span class="p">,</span><span class="w">
              </span><span class="m">48.68000</span><span class="p">,</span><span class="m">46.30766</span><span class="p">,</span><span class="m">47.07444</span><span class="p">,</span><span class="m">47.04333</span><span class="p">,</span><span class="m">47.07954</span><span class="p">,</span><span class="m">46.83285</span><span class="p">,</span><span class="w">
              </span><span class="m">47.12808</span><span class="p">,</span><span class="m">46.59692</span><span class="p">,</span><span class="m">47.03222</span><span class="p">,</span><span class="m">47.06032</span><span class="p">,</span><span class="m">46.75889</span><span class="p">,</span><span class="m">46.96508</span><span class="p">,</span><span class="w">
              </span><span class="m">46.52520</span><span class="p">,</span><span class="m">45.66722</span><span class="p">,</span><span class="m">45.82285</span><span class="p">,</span><span class="m">45.02620</span><span class="p">,</span><span class="m">45.37050</span><span class="p">)</span><span class="w">

</span><span class="c1">#Longitude coordinates of Bigfoot sightings in MT</span><span class="w">
</span><span class="n">longitude</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-109.64490</span><span class="p">,</span><span class="m">-112.57100</span><span class="p">,</span><span class="m">-112.45540</span><span class="p">,</span><span class="m">-115.39030</span><span class="p">,</span><span class="m">-105.86420</span><span class="p">,</span><span class="w">
               </span><span class="m">-104.19220</span><span class="p">,</span><span class="m">-113.11980</span><span class="p">,</span><span class="m">-108.68730</span><span class="p">,</span><span class="m">-110.33080</span><span class="p">,</span><span class="m">-113.83810</span><span class="p">,</span><span class="w">
               </span><span class="m">-110.77810</span><span class="p">,</span><span class="m">-111.56300</span><span class="p">,</span><span class="m">-115.64180</span><span class="p">,</span><span class="m">-111.88610</span><span class="p">,</span><span class="m">-113.69250</span><span class="p">,</span><span class="w">
               </span><span class="m">-113.12360</span><span class="p">,</span><span class="m">-111.12500</span><span class="p">,</span><span class="m">-113.75930</span><span class="p">,</span><span class="m">-111.97440</span><span class="p">,</span><span class="m">-109.55280</span><span class="p">,</span><span class="w">
               </span><span class="m">-111.26440</span><span class="p">,</span><span class="m">-114.2650</span><span class="p">,</span><span class="m">-111.36370</span><span class="p">,</span><span class="m">-110.78970</span><span class="p">,</span><span class="m">-113.82000</span><span class="p">,</span><span class="w">
               </span><span class="m">-113.14240</span><span class="p">,</span><span class="m">-111.96250</span><span class="p">,</span><span class="m">-112.70310</span><span class="p">,</span><span class="m">-112.56490</span><span class="p">,</span><span class="m">-112.70200</span><span class="p">,</span><span class="w">
               </span><span class="m">-111.90940</span><span class="p">,</span><span class="m">-110.62680</span><span class="p">,</span><span class="m">-114.09060</span><span class="p">,</span><span class="m">-114.07170</span><span class="p">,</span><span class="m">-114.08000</span><span class="p">,</span><span class="w">
               </span><span class="m">-114.07250</span><span class="p">,</span><span class="m">-113.59110</span><span class="p">,</span><span class="m">-110.80690</span><span class="p">,</span><span class="m">-114.01250</span><span class="p">,</span><span class="m">-106.83310</span><span class="p">,</span><span class="w">
               </span><span class="m">-112.97070</span><span class="p">)</span><span class="w">

</span><span class="c1">#GPS coordinates of Bigfoot sightings in MT</span><span class="w">
</span><span class="n">BigfootSightingsMT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">longitude</span><span class="p">,</span><span class="w"> </span><span class="n">latitude</span><span class="p">)</span></code></pre></figure>

<p>We can plot the data using the following code.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mt_range</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="s2">"state"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Montana"</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="o">$</span><span class="n">range</span><span class="w">
</span><span class="n">xrange</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">mt_range</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">yrange</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">mt_range</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">])</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">BigfootSightingsMT</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="n">BigfootSightingsMT</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Latitude"</span><span class="p">,</span><span class="w">
     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Longitude"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"GPS coordinates of Bigfoot sightings
     in Montana"</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mt_range</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">.1</span><span class="o">*</span><span class="n">xrange</span><span class="p">,</span><span class="w"> </span><span class="n">mt_range</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">.1</span><span class="o">*</span><span class="n">xrange</span><span class="p">),</span><span class="w">
     </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mt_range</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">yrange</span><span class="p">,</span><span class="w"> </span><span class="n">mt_range</span><span class="p">[</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">yrange</span><span class="p">),</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w">
</span><span class="n">map</span><span class="p">(</span><span class="s2">"state"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Montana"</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span></code></pre></figure>

<center>
<embed width="100%" src="../../assets/tda-rips/bigfoot.svg" type="image/svg+xml" />
</center>

<p>Now, let’s compute the filtration and visualize it with an animation. In order to speed up the computation, we will set maxscale = 2.5 and maxdimension = 3.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">BigfootRipsFilt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ripsFiltration</span><span class="p">(</span><span class="n">BigfootSightingsMT</span><span class="p">,</span><span class="w"> </span><span class="n">maxdimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w">
                                  </span><span class="n">maxscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"euclidean"</span><span class="p">)</span><span class="w">

</span><span class="nf">class</span><span class="p">(</span><span class="n">BigfootRipsFilt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">class</span><span class="p">(</span><span class="n">BigfootRipsFilt</span><span class="p">),</span><span class="w"> </span><span class="s2">"rips_filt"</span><span class="p">)</span><span class="w">

</span><span class="n">plot_rips_bigfoot</span><span class="p">(</span><span class="n">BigfootRipsFilt</span><span class="p">,</span><span class="w"> </span><span class="n">animate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">fn_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'bigfoot.gif'</span><span class="p">,</span><span class="w">
     </span><span class="n">lout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">120</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">ani.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">240</span><span class="p">,</span><span class="w"> </span><span class="n">ani.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">240</span><span class="o">*</span><span class="m">2</span><span class="p">)</span></code></pre></figure>

<center>
<embed width="80%" height="auto" src="../../assets/tda-rips/bigfoot.gif" />
</center>

<p>Furthermore, we can look at the Rips complex at a threshold of 0.8.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot_rips_bigfoot</span><span class="p">(</span><span class="n">BigfootRipsFilt</span><span class="p">,</span><span class="w"> </span><span class="n">thresh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">animate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span></code></pre></figure>

<center>
<embed width="80%" src="../../assets/tda-rips/bigfootcomplex1.svg" type="image/svg+xml" />
</center>

<p>As we watch the animation, we see that the Rips filtration captures geometric properties about the data set since simplices quickly arise in the filtraion in the locations that reported the most bigfoot sightings. Furthermore, we see the filtration also reveals some topological information about the data set. In particular, at a filtration value of 0.698812, five edges that form a cycle appear around the GPS coordinate (-111, 46). Furthermore, this cycle persists until the filtration value of 0.94698369. Considering the amount of land that is covered in 1 longitude/latitude unit, this cycle could tell us something meaningful about our data. Perhaps this hole is a deadzone where Bigfoot has yet to be found, or maybe this area is inaccessible to humans and that is why there has not been sightings. Regardless of the answer, this cycle provides us guidance for the next step to take to solve the Bigfoot mystery!</p>

<h2 id="references">References</h2>

<ol class="bibliography"><li><span id="edelsbrunner:2010">Edelsbrunner, H., &amp; Harer, J. (2010). <i>Computational Topology - an Introduction.</i> (pp. 1–241). American Mathematical Society.</span></li>
<li><span id="ghrist:2007">Silva, V. de, &amp; Ghrist, R. (2007). Coverage in Sensor Networks via Persistent Homology. <i>Algebraic &amp; Geometric Topology</i>, <i>7</i>. https://doi.org/10.2140/agt.2007.7.339</span></li>
<li><span id="attali:2013">Attali, D., Lieutier, A., &amp; Salinas, D. (2013). Vietoris–Rips Complexes also Provide Topologically Correct Reconstructions of Sampled Shapes. <i>Computational Geometry</i>, <i>46</i>(4), 448–465. https://doi.org/https://doi.org/10.1016/j.comgeo.2012.02.009</span></li></ol>


  </div>

</article>

<div class="container mx-auto px-2 py-2 clearfix">
  <!-- Use if you want to show previous and next for all posts. -->



  <div class="col-4 sm-width-full left mr-lg-4 mt-3">
    <a class="no-underline border-top-thin py-1 block" href="https://comptag.github.io/rpackage_tutorials//2019/04/persistent_homology.html">
      <span class="h5 bold text-accent">Previous</span>
      <p class="bold h3 link-primary mb-1">Persistent Homology and Persistence Diagrams</p>
      <p>Introduction to Persistent Homology Objectives Understand and be able to define persistent homology Conceptualize the importance of persistent homology in...</p>
    </a>
  </div>
  
  

</div>

    </div>

    <div class="border-top-thin clearfix mt-2 mt-lg-4">
  <div class="container mx-auto px-2">
    <p class="col-8 sm-width-full left py-2 mb-0">This project is maintained by <a class="text-accent" href="https://github.com/benholmgren">benholmgren</a></p>
    <ul class="list-reset right clearfix sm-width-full py-2 mb-2 mb-lg-0">
      <li class="inline-block mr-1">
        <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="Topology for Data Science">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      </li>
      <li class="inline-block">
        <a class="github-button" href="https://github.com/benholmgren/" data-icon="octicon-star" data-count-href="benholmgren//stargazers" data-count-api="/repos/benholmgren/#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star benholmgren/ on GitHub">Star</a>
      </li>
    </ul>
  </div>
</div>


  </body>

</html>
