<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Kernel Density Estimation</title>
  <meta name="description" content="Tutorial on Kernel Density Estimation">

  
  
  <link rel="stylesheet" href="https://comptag.github.io/rpackage_tutorials//assets/style.css">

  <link rel="canonical" href="https://comptag.github.io/rpackage_tutorials//2019/04/kde.html">
  <link rel="alternate" type="application/rss+xml" title="Topology for Data Science" href="https://comptag.github.io/rpackage_tutorials//feed.xml">

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>

    <header class="border-bottom-thick px-2 clearfix">
  <div class="left sm-width-full py-1 mt-1 mt-lg-0">
    <a class="align-middle link-primary text-accent" href="/rpackage_tutorials//">
      Topology for Data Science
    </a>
  </div>
  <div class="right sm-width-full">
    <ul class="list-reset mt-lg-1 mb-2 mb-lg-1">
      
        
      
        
        <li class="inline-block">
          <a class="align-middle link-primary mr-2 mr-lg-0 ml-lg-2" href="/rpackage_tutorials//about/">
            About
          </a>
        </li>
        
      
        
      
        
      
        
      
    </ul>
  </div>
</header>


    <div>
      <article class="container px-2 mx-auto mb4" itemscope itemtype="http://schema.org/BlogPosting">
  <h1 class="h0 col-9 sm-width-full py-4 mt-3 inline-block" itemprop="name headline">Kernel Density Estimation</h1>
  <div class="col-4 sm-width-full mt-1 border-top-thin ">
    <p class="mb-3 py-2 bold h4"><time datetime="2019-04-15T00:00:00+00:00" itemprop="datePublished">Apr 15, 2019</time></p>
  </div>

  <div class="prose" itemprop="articleBody">
      <h1 id="tutorial-on-kernel-density-estimation">Tutorial on Kernel Density Estimation</h1>

<hr />
<h3 id="objectives">Objectives</h3>
<p>We want to be able to understand the questions:</p>
<ul>
  <li>What is a kernel? Not that of your pre popped corn, nor a high ranking military officer, the kind that’s useful when thinking about data.</li>
  <li>How can kernels be of use to understand a set of data?</li>
  <li>What are a few exciting applications of kernel density estimation?</li>
  <li>Every year in Bozeman, Montana, an epic trail race kown as the Bridger Ridge Run takes place in which runners test themselves for 20 grueling miles to see who can most quickly traverse the Bridger Ridge. The citizens of Bozeman, Montana, or “Bozemanites” as they often refer to themselves, carry with them a serious level of pride in their ability to complete these sorts of challenges better than people throughout the rest of the world. As the Bridger Ridge Run has grown into a widely famous race around the country, the superiority of Bozemanites at traversing their beloved ridge is being tested like never before. By the end of this tutorial, we will use Kernel Density Estimation to decide, is there merit to the longheld Bozemanite belief of their ridge traversing superiority, or have the proud people of Bozeman been surpassed by nonlocal runners in this famous ridge traverse?</li>
</ul>

<hr />
<h1 id="what-is-a-kernel">What is a kernel?</h1>
<p>To begin, visualize a number line with points lying along it, as follows:</p>

<hr />

<p><img src="/rpackage_tutorials/assets/kde-images/kdeNumberLine.png" alt="Number Line" /></p>

<hr />

<p>Now, recall a Gaussian curve, the “bell curve” which portrays a normal distribution. The Gaussian curve is visualized by:
<img src="/rpackage_tutorials/assets/kde-images/Gaussian.png" alt="Gaussian Ex" /></p>

<hr />

<p>With this in mind, visualize the insertion of a Gaussian curve above each point on our data set on the number line:</p>

<hr />

<p><img src="/rpackage_tutorials/assets/kde-images/kdeKernelsonLine.png" alt="Kernels on line" /></p>

<hr />

<p>We call the curves inserted above these points kernels. In this example, we’ve chosen to use Gaussian curves as kernels,
though other implementations include:</p>
<ul>
  <li>Rectangular kernels</li>
  <li>Triangular kernels</li>
  <li>Biweight kernels</li>
  <li>Uniform kernels</li>
  <li>Cosine kernels</li>
  <li>Epanechnikov kernels</li>
</ul>

<h4 id="however-for-functional-purposes-we-are-primarily-concerned-with-gaussian-and-epanechnikov-kernels-specifically-weve-seen-some-exposure-to-gaussian-kernels-and-epanechnikov-kernels-are-conceptually-quite-similar-but-are-parabolic-rather-than-normally-distributed-in-nature">However, for functional purposes we are primarily concerned with Gaussian and Epanechnikov kernels specifically. We’ve seen some exposure to Gaussian kernels, and Epanechnikov kernels are conceptually quite similar but are parabolic rather than normally distributed in nature.</h4>
<ul>
  <li>
    <p>Gaussian kernels are specifically useful since they are naturally distributed. This yields a natural sort of probability in location for each data point, and when taken as a sum of all the points in a data set is actually quite effective in representing the data. A Gaussian kernel K(u) is defined to be:</p>

    <h2><img src="/rpackage_tutorials/assets/kde-images/kdeGaussianformula.png" alt="Gaussian formula" /></h2>
  </li>
  <li>
    <p>Epanechnikov kernels are useful in their own right, and are representative of data in a manner similar to Gaussian kernels. However, the difference in Epanechnikov kernels lies in their parabolic structure. This is useful for data in which we need to take into account areas with zero density. More formally, this is referred to as <em>compact support</em>, having a closed and bounded domain. When using Gaussian curves, there will always be a nonzero kernel value occupying the space, since Gaussian curves never reach zero. The function for an Epanechnikov kernel K(u) is defined as:</p>

    <p><img src="/rpackage_tutorials/assets/kde-images/kdeEpanechnikovformula.png" alt="Epanechnikov formula" /></p>
  </li>
</ul>

<hr />
<p>Summing all of our Gaussian kernels together, we gain a nice visualization of the densities of the original points on the number line</p>

<hr />

<p><img src="/rpackage_tutorials/assets/kde-images/kdeKernelSum.png" alt="Kernel Sum" /></p>

<hr />

<p>Conceptually, this is the central goal of kernel density estimation. In order to understand sets of data, it is incredibly useful to project their densities in some manner above a set in order to view similarities in their values and to view data in a more probabilistic manner. Adding dimensions, for an n dimensional set of data, we find an n + 1 dimensional kernel density estimate. Thus, for a set of 2 dimensional data, we can construct a similar density visualization in R<sup>3</sup>.</p>

<p>Consider the position of some occurance of data on a plane. We can visualize the density of that data positionally by different 3 dimensional plots of kernel density, each plot referring to a specific variable which we are concerned with positionally. This graph comes from a paper on geolocation, considering the densities of particular words geographically on Twitter.</p>

<p><img src="/rpackage_tutorials/assets/kde-images/wordDensities.png" alt="Word Densities" /></p>

<hr />

<h2 id="applications-of-kde">Applications of kde</h2>
<p>Kernel density estimation is widely applicable as a relatively intuitive, nonparametric method to model the structure of a data set. Below are just a few of countless applications kde can have when interpreting data.</p>
<h3 id="ai">AI</h3>
<ul>
  <li>Image Classification: Unsurprisingly, kernel density estimation is incredibly useful when trying to categorize images. <a href="http://www.gatsby.ucl.ac.uk/~dougals/papers/cvpr-12.pdf" title="kde in image classification">“Nonparametric Kernel Density Estimators for Image Classification”</a> gives a good overview of kernel density estimators for image classification as well as proposing new, nonparametric methods to do so which improve upon existing methods.</li>
  <li>Geolocation: Kernel density estimation is immediately applicable to any sort of map, as it is an easy way to understand the densities of a particular phenomenon in a space. One pertinent example comes with the graph included above, when considering the densities of word use on Twitter in specific regions.
This instance brought up in <a href="https://www.aaai.org/ocs/index.php/AAAI/AAAI15/paper/view/10034" title="kde in geolocation">“Kernel Density Estimation for Text-Based Geolocation”</a> is easily extended to countless data distributed geographically.
    <h3 id="econometrics">Econometrics</h3>
  </li>
  <li>Understanding the probability involved with economic data. Econometricians can utilize kde in order to understand the overall trends in economic data, in hopes to explain the root causes of economic trends. For more information, see
<a href="https://arxiv.org/abs/1212.2812" title="kde in econometrics">“kde in econometrics”</a>.
—
    <h2 id="kde-in-the-r-package-tda">kde in the R package ‘TDA’</h2>
  </li>
</ul>

<p><a href="https://www.rdocumentation.org/packages/TDA/versions/1.6.2/topics/kde" title="kde R Documentation">R package</a></p>

<hr />
<p>Kernel density estimation can be accomplished by use of the R package ‘TDA’ through the kde function. By this means, it is possible to input data and recieve an actual numerical assessment of kernel density on that data.</p>

<p>The kde function considers:</p>
<ul>
  <li>Two input matrices, one corresponding to each point in a data set of concern, and the other corresponding to a base grid from which the matrix refers to.</li>
  <li>A smoothing parameter in order to mitigate some level of statistical noise in the data if necessary.</li>
  <li>The type of kernel desired- allowed to be either Gaussian or Epanechnikov</li>
  <li>A weight parameter which allows certain data points to be weighted more or less in the kernel density, prioritizing or deprioritizing aspects of the data if useful</li>
</ul>

<p>And then returns a vector containing the value of the kernel density estimator at each point in the base grid. This provides a rough quantification of kernel density at each point in a considered space, which is very useful in order to actually use the values associated with a kernel density estimate.</p>

<p><img src="/rpackage_tutorials/assets/kde-images/Rlogo.jpeg" alt="R" /></p>

<h1 id="generic-example-using-points-along-the-unit-circle">Generic example using points along the unit circle:</h1>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">TDA</span><span class="p">)</span><span class="w">
</span><span class="c1">#Generate Data from the unit circle</span><span class="w">

</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">300</span><span class="w">
</span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">TDA</span><span class="o">::</span><span class="n">circleUnif</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">

</span><span class="c1">#Construct a grid of points over which we evaluate the function</span><span class="w">

</span><span class="n">by</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.065</span><span class="w">
</span><span class="n">Xseq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">-1.6</span><span class="p">,</span><span class="w"> </span><span class="m">1.6</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">)</span><span class="w">
</span><span class="n">Yseq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">-1.7</span><span class="p">,</span><span class="w"> </span><span class="m">1.7</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">)</span><span class="w">
</span><span class="n">Grid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">expand.grid</span><span class="p">(</span><span class="n">Xseq</span><span class="p">,</span><span class="n">Yseq</span><span class="p">)</span><span class="w">

</span><span class="c1">#kernel density estimator</span><span class="w">

</span><span class="n">h</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.3</span><span class="w">

</span><span class="n">KDE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">TDA</span><span class="o">::</span><span class="n">kde</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Grid</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">)</span></code></pre></figure>

<hr />
<h1 id="kernel-density-estimation-to-settle-the-superiority-of-bozemanites-in-the-bridger-ridge-run">Kernel Density Estimation to settle the superiority of Bozemanites in the Bridger Ridge Run:</h1>

<p><img src="/rpackage_tutorials/assets/kde-images/bridgerRidge.png" alt="Bridger Run" />
<!-- <img src="briedgerridge.png" width="700" height="656.25" /> --></p>

<h2 id="the-bridger-ridge-as-seen-from-just-below-the-summit-of-naya-nuki">The Bridger Ridge, as seen from just below the summit of Naya Nuki.</h2>
<p>To settle once and for all the Bozemanite supremacy in traversing mountain ridges, we can take a look at a kernel density estimation using the times in the 2018 <a href="https://winddrinkers.org/trailhead/races/ridge-run/" title="Ed Anacker Bridger Ridge Run">Ridge Run</a> in seconds. The kernel density is constructed with the following code in the R package ‘TDA’.</p>

<h4 id="sample-code">Sample Code:</h4>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#Times of Bozeman runners in top 30 of Ridge Run (in seconds)</span><span class="w">
</span><span class="n">RTBOZE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">12909</span><span class="p">,</span><span class="w"> </span><span class="m">13204</span><span class="p">,</span><span class="w"> </span><span class="m">13268</span><span class="p">,</span><span class="w"> </span><span class="m">14497</span><span class="p">,</span><span class="w"> </span><span class="m">14964</span><span class="p">,</span><span class="w"> </span><span class="m">15304</span><span class="p">,</span><span class="w"> </span><span class="m">15350</span><span class="p">,</span><span class="w"> </span><span class="m">15437</span><span class="p">,</span><span class="w"> </span><span class="m">15751</span><span class="p">,</span><span class="w"> </span><span class="m">15752</span><span class="p">,</span><span class="w"> </span><span class="m">15804</span><span class="p">,</span><span class="w"> </span><span class="m">15842</span><span class="p">,</span><span class="w"> </span><span class="m">16754</span><span class="p">,</span><span class="w"> </span><span class="m">16780</span><span class="p">,</span><span class="w"> </span><span class="m">16877</span><span class="p">,</span><span class="w"> </span><span class="m">16978</span><span class="p">))</span><span class="w">
</span><span class="n">by</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="n">xseq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">12900</span><span class="p">,</span><span class="w"> </span><span class="m">17000</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="p">)</span><span class="w">
</span><span class="n">Grid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">expand.grid</span><span class="p">(</span><span class="n">xseq</span><span class="p">)</span><span class="w">
</span><span class="n">h</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">

</span><span class="n">KDEBOZE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">kde</span><span class="p">(</span><span class="n">RTBOZE</span><span class="p">,</span><span class="w"> </span><span class="n">Grid</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">)</span></code></pre></figure>

<p>#Kernel Density Estimator of Bozeman Runners</p>

<p>#Times of runners in top 30 of Ridge Run from outside of Bozeman (in seconds)</p>

<p>RTOTHER &lt;- matrix(c(14096, 14391, 14678, 14792, 14811, 14940, 15343, 15777, 15797, 15811, 15968, 16605, 16660, 16761))</p>

<p>KDEOTHER &lt;- kde(RTOTHER, Grid, h)
```</p>
<h2 id="outcome">Outcome:</h2>
<p>While not by any means a complete picture, by considering the kernel density estimation of Bozeman runners vs. runners from outside of Bozeman in the top 30 places in the 2018 Bridger Ridge Run, we can see a slight disparity between the outcomes, which of course, favors Bozemanites.</p>

<p>//TODO: Display findings of estimation graphically, ask Dave
// GGPLOT</p>

<hr />
<h2 id="works-cited">Works cited:</h2>

<p>Hulden, Mans, et al. “Kernel Density Estimation for Text-Based Geolocation.” AAAI Publications, Twenty-Ninth AAAI Conference on Artificial Intelligence, AAAI Conference on Artificial Intelligence, 9 Feb. 2015, www.aaai.org/ocs/index.php/AAAI/AAAI15/paper/view/10034.</p>

<p>Rhodes, Anthony, et al. “Fast On-Line Kernel Density Estimation for Active Object Localization.” ArXiv.org, Cornell University, 16 Nov. 2016, arxiv.org/abs/1611.05369.</p>

<p>Zanin, Adriano, and Ronaldo Dias. “A Review of Kernel Density Estimation with Applications to Econometrics.” ArXiv.org, Cornell University, 12 Dec. 2012, arxiv.org/abs/1212.2812.</p>

<p>All images created with Desmos online calculator</p>

  </div>

</article>

<div class="container mx-auto px-2 py-2 clearfix">
  <!-- Use if you want to show previous and next for all posts. -->



  
  <div class="col-4 sm-width-full left mt-3">
    <a class="no-underline border-top-thin py-1 block" href="https://comptag.github.io/rpackage_tutorials//2019/04/rips.html">
      <span class="h5 bold text-accent">Next</span>
      <p class="bold h3 link-primary mb-1">Rips Filtration</p>
      <p># Tutorial on Rips Filtrations --- #### Objectives * Gain familiarity with simplices and simplicial complexes * Be able to...</p>
    </a>
  </div>


</div>

    </div>

    <div class="border-top-thin clearfix mt-2 mt-lg-4">
  <div class="container mx-auto px-2">
    <p class="col-8 sm-width-full left py-2 mb-0">This project is maintained by <a class="text-accent" href="https://github.com/benholmgren">benholmgren</a></p>
    <ul class="list-reset right clearfix sm-width-full py-2 mb-2 mb-lg-0">
      <li class="inline-block mr-1">
        <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="Topology for Data Science">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      </li>
      <li class="inline-block">
        <a class="github-button" href="https://github.com/benholmgren/" data-icon="octicon-star" data-count-href="benholmgren//stargazers" data-count-api="/repos/benholmgren/#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star benholmgren/ on GitHub">Star</a>
      </li>
    </ul>
  </div>
</div>


  </body>

</html>
